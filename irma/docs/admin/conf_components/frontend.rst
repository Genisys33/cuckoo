Frontend configuration
======================

.. _frontend-app-configuration:

Configuration
-------------

The configuration file is located at ``config/frontend.ini`` in the installation
directory.

.. note:: Detailed meaning of each field in ``config/frontend.ini``:

     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |     Section    |         Key      |    Type    |    Default     | Description                                             |
     +================+==================+============+================+=========================================================+
     |                |       syslog     | ``integer``|       0        | enable rsyslog (experimental)                           |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |       prefix     | ``string`` | irma-frontend: | prefix to append to rsyslog entries                     |
     |  log           +------------------+------------+----------------+---------------------------------------------------------+
     |                |       debug      | ``boolean``|     False      | enable Debug log                                        |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |     sql_debug    | ``boolean``|     False      | enable SQL debug log                                    |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |                |      username    | ``string`` |                | database username                                       |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |      password    | ``string`` |                | database password                                       |
     |    sqldb       +------------------+------------+----------------+---------------------------------------------------------+
     |                |        host      | ``string`` |                | database host                                           |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |        port      | ``integer``|                | database port                                           |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |       dbname     | ``string`` |                | database name                                           |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |   tables_prefix  | ``string`` |                | database tables prefix                                  |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     | samples_storage|        path      | ``string`` |                | Samples storage path                                    |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |celery_brain    |       timeout    | ``integer``|    60 (sec)    | time before considering that the brain has timed-out    |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |celery_frontend |     timeout      | ``integer``|    30 (sec)    | time before considering that the frontend has timed-out |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |                |    concurrency   |  `integer` |     0          | number of concurrent workers (0 means nb of cores)      |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |  soft_time_limit | ``integer``|    300  (sec)  | time limit before task soft interrupt                   |
     | celery_options +------------------+------------+----------------+---------------------------------------------------------+
     |                |     time_limit   | ``integer``|    1500 (sec)  | time limit before task is killed                        |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |   beat_schedule  | ``string`` |/var/irma/fronte| celery beat schedule file                               |
     |                |                  |            |nd_beat_schedule|                                                         |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |                |        host      | ``string`` |                | hostname for the RabbitMQ server                        |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |        port      |``integer`` |     5672       | port for the RabbitMQ server                            |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |broker_brain    |        vhost     | ``string`` |                | virtual host configured for brain                       |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |      username    | ``string`` |                | username used for brain on the RabbitMQ server          |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |      password    | ``string`` |                | password used for brain on the RabbitMQ server          |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |        queue     | ``string`` |                | queue to poll new tasks on the RabbitMQ server          |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |                |        host      | ``string`` |                | hostname for the RabbitMQ server                        |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |        port      |``integer`` |      5672      | port for the RabbitMQ server                            |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |broker_frontend |        vhost     | ``string`` |                | virtual host configured for this frontend               |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |      username    | ``string`` |                | username used for this frontend on the RabbitMQ server  |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |      password    | ``string`` |                | password used for this frontend on the RabbitMQ server  |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |        queue     | ``string`` |                | queue to poll new tasks on the RabbitMQ server          |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |      ftp       |      protocol    | ``string`` |     "sftp"     | choose File Transfer Protocol ("sftp" or "ftps")        |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |                |        host      | ``string`` |                | hostname for the FTP server                             |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |        port      |``integer`` |       22       | port for the FTP server                                 |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |        auth      | ``string`` |   "password"   | SFTP authentication method ("password" or "key")        |
     |   ftp_brain    +------------------+------------+----------------+---------------------------------------------------------+
     |                |      key_path    | ``string`` |                | sftp private key absolute path                          |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |      username    | ``string`` |                | username used by this frontend on the FTP server        |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |      password    | ``string`` |                | password used by this frontend on the FTP server        |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |                |   clean_fs_max   | ``string`` |       "0"      | remove file when not scanned for givent time            |
     |                |       _age       |            |                | 0 means disabled ("1 hour", "5 days", "3w", "1year")    |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |   clean_fs_age   | ``string`` |        0       | cron hour settings                                      |
     |                |    _cron_hour    |            |                |                                                         |
     |cron_clean_file +------------------+------------+----------------+---------------------------------------------------------+
     |     _age       |   clean_fs_age   | ``string`` |        0       | cron minute settings                                    |
     |                |   _cron_minute   |            |                |                                                         |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                | clean_fs_age     | ``string`` |        \*      | cron day of week settings                               |
     |                | _cron_day_of_week|            |                |                                                         |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |                |   clean_fs_max   | ``string`` |       "0"      | space's maximum size dedicated to the file system       |
     |                |      _size       |            |                | ("100 Mb", "512 Mb", "1.5Gb")                           |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |   clean_fs_size  | ``string`` |        \*      | cron hour settings                                      |
     |                |    _cron_hour    |            |                |                                                         |
     |cron_clean_file +------------------+------------+----------------+---------------------------------------------------------+
     |    _size       |   clean_fs_size  | ``string`` |        0       | cron minute settings                                    |
     |                |   _cron_minute   |            |                |                                                         |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                | clean_fs_size    | ``string`` |        \*      | cron day of week settings                               |
     |                | _cron_day_of_week|            |                |                                                         |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     | interprocess   |      path        | ``string`` |/var/run/lock/ir| Concurrency file lock                                   |
     | _lock          |                  |            |ma-frontend.lock|                                                         |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+
     |                |    activate_ssl  | ``boolean``|    False       | Enable RabbitMQ ssl                                     |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |     ca_certs     | ``string`` |                | RabbitMQ SSL certs                                      |
     |  ssl_config    +------------------+------------+----------------+---------------------------------------------------------+
     |                |      keyfile     | ``string`` |                | RabbitMQ SSL keyfile                                    |
     |                +------------------+------------+----------------+---------------------------------------------------------+
     |                |     certfile     | ``string`` |                | RabbitMQ SSL certfile                                   |
     +----------------+------------------+------------+----------------+---------------------------------------------------------+

.. note::

    The default path for samples is /var/irma/samples/ make sure it exists with correct rights for irma user
    before launching your first scan.
